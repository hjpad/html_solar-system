<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System 3D</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
        }
        .info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            pointer-events: none;
            z-index: 10;
        }
        .planet-label {
            position: absolute;
            color: white;
            font-size: 12px;
            pointer-events: none;
            text-shadow: 0 0 3px black, 0 0 3px black, 0 0 3px black, 0 0 3px black;
            white-space: nowrap;
            opacity: 0.8;
        }
        .planet-info-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 0;
            text-align: center;
            display: none;
            pointer-events: none;
            z-index: 100;
        }
        .planet-info-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }
        .planet-info-content h2 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }
        .planet-info-content p {
            margin: 5px 0;
            font-size: 14px;
            text-align: left;
        }
        .planet-info-stats {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 10px 0;
        }
        .planet-info-stats p {
            margin: 5px 15px;
        }
        .planet-description {
            margin: 15px 0;
            line-height: 1.5;
            text-align: justify;
        }
        .planet-image {
            max-width: 300px;
            max-height: 200px;
            border-radius: 5px;
            margin: 10px 0;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="planet-info-panel" id="planetInfo">
        <div class="planet-info-content">
            <h2>Solar System</h2>
            <p>Click on a planet to view details</p>
        </div>
    </div>
    <div class="info">Click and drag to rotate the view. Scroll to zoom in/out.</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Initialize Three.js scene
        const scene = new THREE.Scene();
        
        // Create camera
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 15;
        camera.position.y = 5;
        
        // Create renderer
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        
        // Create container for the entire scene
        const spaceContainer = new THREE.Object3D();
        scene.add(spaceContainer);
        
        // Create stars
        const starGeometry = new THREE.BufferGeometry();
        const starMaterial = new THREE.PointsMaterial({
            color: 0xffffff,
            size: 0.05,
        });
        
        const starVertices = [];
        for (let i = 0; i < 10000; i++) {
            const x = (Math.random() - 0.5) * 2000;
            const y = (Math.random() - 0.5) * 2000;
            const z = (Math.random() - 0.5) * 2000;
            starVertices.push(x, y, z);
        }
        
        starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
        const stars = new THREE.Points(starGeometry, starMaterial);
        spaceContainer.add(stars);
        
        // Add lights
        const pointLight = new THREE.PointLight(0xffffff, 2);
        pointLight.position.set(0, 0, 0);
        spaceContainer.add(pointLight);
        
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        
        // Planet data with physical properties
        const celestialBodiesData = [
            {
                name: "Sun",
                radius: 2,
                realRadius: "696,340 km",
                color: 0xffdd00,
                mass: "1.989 × 10^30 kg",
                distance: 0,
                realDistance: "0 km (center)",
                yearPeriod: "N/A",
                dayPeriod: "25-35 Earth days",
                inclination: 0,
                eccentricity: 0,
                isSun: true,
                description: "The Sun is the star at the center of our Solar System. It's a nearly perfect sphere of hot plasma, heated to incandescence by nuclear fusion reactions in its core. The Sun radiates energy mainly as light, ultraviolet, and infrared radiation, and is the most important source of energy for life on Earth.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/sun.jpg"
                // imageUrl: "./images/sun.jpg"
            },
            {
                name: "Mercury",
                radius: 0.4,
                realRadius: "2,439.7 km",
                color: 0x888888,
                distance: 4,
                realDistance: "57.9 million km",
                speed: 0.01,
                mass: "3.3011 × 10^23 kg",
                yearPeriod: "88 Earth days",
                dayPeriod: "58.6 Earth days",
                inclination: 7.0,
                eccentricity: 0.206,  // Most eccentric of the planets
                description: "Mercury is the smallest and innermost planet in the Solar System. It has no atmosphere to retain heat, causing extreme temperature variations, with scorching days and freezing nights. Its surface is heavily cratered, similar to the Moon.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/mercury-from-messenger-pia15160-1920x640-1.jpg"
            },
            {
                name: "Venus",
                radius: 0.6,
                realRadius: "6,051.8 km",
                color: 0xffa500,
                distance: 6,
                realDistance: "108.2 million km",
                speed: 0.007,
                mass: "4.8675 × 10^24 kg",
                yearPeriod: "225 Earth days",
                dayPeriod: "243 Earth days",
                inclination: 3.4,
                eccentricity: 0.007,  // Nearly circular
                description: "Venus is the second planet from the Sun and Earth's closest planetary neighbor. It has a thick, toxic atmosphere filled with carbon dioxide and clouds of sulfuric acid. The atmosphere traps heat, making Venus the hottest planet in our solar system.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/venus.jpg"
            },
            {
                name: "Earth",
                radius: 0.65,
                realRadius: "6,371 km",
                color: 0x3333ff,
                distance: 8,
                realDistance: "149.6 million km",
                speed: 0.005,
                mass: "5.972 × 10^24 kg",
                yearPeriod: "365.25 days",
                dayPeriod: "24 hours",
                inclination: 0,
                eccentricity: 0.017,  // Slightly elliptical
                description: "Earth is the third planet from the Sun and the only astronomical object known to harbor life. About 71% of Earth's surface is covered with water. Earth's atmosphere consists primarily of nitrogen and oxygen, allowing for liquid water oceans and supporting a wide variety of life forms.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/as17-148-22727_lrg.jpg"
            },
            {
                name: "Mars",
                radius: 0.5,
                realRadius: "3,389.5 km",
                color: 0xff4500,
                distance: 10,
                realDistance: "227.9 million km",
                speed: 0.004,
                mass: "6.4171 × 10^23 kg",
                yearPeriod: "687 Earth days",
                dayPeriod: "24.6 hours",
                inclination: 1.9,
                eccentricity: 0.093,  // Moderately elliptical
                description: "Mars is the fourth planet from the Sun and the second-smallest planet in the Solar System. It's often called the 'Red Planet' due to its reddish appearance, caused by iron oxide (rust) on its surface. Mars has polar ice caps, seasons, canyons, extinct volcanoes, and evidence of ancient rivers.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/mars-perseverance.jpg"
            },
            {
                name: "Jupiter",
                radius: 1.2,
                realRadius: "69,911 km",
                color: 0xffb90f,
                distance: 14,
                realDistance: "778.5 million km",
                speed: 0.002,
                mass: "1.898 × 10^27 kg",
                yearPeriod: "11.86 Earth years",
                dayPeriod: "9.93 hours",
                inclination: 1.3,
                eccentricity: 0.048,
                description: "Jupiter is the fifth planet from the Sun and the largest in the Solar System. It's a gas giant primarily composed of hydrogen and helium. Jupiter's iconic Great Red Spot is a giant storm that has been raging for hundreds of years. It has a strong magnetic field and at least 79 moons.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/PIA02873.jpg"
            },
            {
                name: "Saturn",
                radius: 1.0,
                realRadius: "58,232 km",
                color: 0xffd700,
                distance: 18,
                realDistance: "1.434 billion km",
                speed: 0.0015,
                mass: "5.683 × 10^26 kg",
                yearPeriod: "29.46 Earth years",
                dayPeriod: "10.7 hours",
                inclination: 2.5,
                eccentricity: 0.056,
                description: "Saturn is the sixth planet from the Sun and the second-largest in the Solar System. It's known for its spectacular ring system, composed mainly of ice particles with smaller amounts of rocky debris and dust. Like Jupiter, Saturn is a gas giant composed mainly of hydrogen and helium.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/PIA01364.jpg"
            },
            {
                name: "Uranus",
                radius: 0.8,
                realRadius: "25,362 km",
                color: 0x00ffff,
                distance: 22,
                realDistance: "2.871 billion km",
                speed: 0.001,
                mass: "8.681 × 10^25 kg",
                yearPeriod: "84.01 Earth years",
                dayPeriod: "17.2 hours",
                inclination: 0.8,
                eccentricity: 0.046,
                description: "Uranus is the seventh planet from the Sun. It's an ice giant with a thick atmosphere of hydrogen, helium, and methane, giving it a blue-green color. Uniquely, Uranus rotates on its side, with its axis pointing nearly toward the Sun during parts of its orbit, causing extreme seasons.",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/PIA18182.jpg"

            },
            {
                name: "Neptune",
                radius: 0.8,
                realRadius: "24,622 km",
                color: 0x0000ff,
                distance: 26,
                realDistance: "4.495 billion km",
                speed: 0.0008,
                mass: "1.024 × 10^26 kg",
                yearPeriod: "164.8 Earth years",
                dayPeriod: "16.1 hours",
                inclination: 1.8,
                eccentricity: 0.010,  // Nearly circular
                description: "Neptune is the eighth and farthest known planet from the Sun. It's an ice giant similar to Uranus, with a blue appearance due to methane in its atmosphere. Neptune has the strongest winds in the Solar System, reaching speeds of 2,100 km/h (1,300 mph).",
                imageUrl: "https://science.nasa.gov/wp-content/uploads/2023/05/PIA01492.jpg"
            }
        ];
        
        // Create a planet with color
        function createCelestialBody(data) {
            const geometry = new THREE.SphereGeometry(data.radius, 32, 32);
            const material = new THREE.MeshBasicMaterial({ color: data.color });
            const body = new THREE.Mesh(geometry, material);
            
            // Store the data with the mesh for raycasting
            body.userData = data;
            
            // Create label element
            const labelElement = document.createElement('div');
            labelElement.className = 'planet-label';
            labelElement.textContent = data.name;
            document.body.appendChild(labelElement);
            
            // Store the label with the body for updating position
            body.userData.labelElement = labelElement;
            
            if (!data.isSun) {
                // Create orbit line with planet's color but more transparent
                const orbitSegments = 128;
                const orbitGeometry = new THREE.BufferGeometry();
                const orbitMaterial = new THREE.LineBasicMaterial({ 
                    color: data.color, 
                    transparent: true, 
                    opacity: 0.4 
                });
                
                const orbitVertices = [];
                for (let i = 0; i <= orbitSegments; i++) {
                    const angle = (i / orbitSegments) * Math.PI * 2;
                    
                    // Calculate elliptical orbit position
                    // For an ellipse: r = a(1-e²)/(1+e*cos(θ)) where a is semi-major axis, e is eccentricity
                    // We'll use distance as our semi-major axis
                    const r = data.distance * (1 - data.eccentricity * data.eccentricity) / 
                             (1 + data.eccentricity * Math.cos(angle));
                    
                    // Calculate position on a tilted elliptical orbit
                    const x = r * Math.cos(angle);
                    const y = r * Math.sin(angle) * Math.sin(data.inclination * Math.PI / 180);
                    const z = r * Math.sin(angle) * Math.cos(data.inclination * Math.PI / 180);
                    
                    orbitVertices.push(x, y, z);
                }
                
                orbitGeometry.setAttribute('position', new THREE.Float32BufferAttribute(orbitVertices, 3));
                const orbit = new THREE.Line(orbitGeometry, orbitMaterial);
                spaceContainer.add(orbit);
                
                // Set initial position on the tilted orbit
                body.position.x = data.distance * (1 - data.eccentricity);
                body.position.y = 0;
                body.position.z = 0;
                
                // Add much larger invisible collision sphere for easier clicking
                const collisionRadius = Math.max(2, data.radius * 3);
                const collisionGeometry = new THREE.SphereGeometry(collisionRadius, 16, 16);
                const collisionMaterial = new THREE.MeshBasicMaterial({ 
                    color: data.color,
                    transparent: true,
                    opacity: 0.0,  // Completely invisible
                    depthWrite: false  // Don't write to depth buffer
                });
                
                const collisionSphere = new THREE.Mesh(collisionGeometry, collisionMaterial);
                collisionSphere.userData = data;  // Copy the same data
                body.add(collisionSphere);  // Add as child to follow the planet
            }
            
            return body;
        }

		// Function to update label positions
		function updateLabelPositions() {
			// Update sun label
			if (sun && sun.userData.labelElement) {
				const sunPos = new THREE.Vector3();
				sun.getWorldPosition(sunPos);
				
				// Project 3D position to 2D screen space
				sunPos.project(camera);
				
				// Convert to screen coordinates
				const x = (sunPos.x * 0.5 + 0.5) * window.innerWidth;
				const y = (-(sunPos.y * 0.5) + 0.5) * window.innerHeight;
				
				// Position label with offset
				sun.userData.labelElement.style.left = `${x + 15}px`;
				sun.userData.labelElement.style.top = `${y - 10}px`;
			}
			
			// Update planet labels
			celestialBodies.forEach(body => {
				if (body.mesh && body.mesh.userData.labelElement) {
					const planetPos = new THREE.Vector3();
					body.mesh.getWorldPosition(planetPos);
					
					// Project 3D position to 2D screen space
					planetPos.project(camera);
					
					// Convert to screen coordinates
					const x = (planetPos.x * 0.5 + 0.5) * window.innerWidth;
					const y = (-(planetPos.y * 0.5) + 0.5) * window.innerHeight;
					
					// Position label with offset
					body.mesh.userData.labelElement.style.left = `${x + 15}px`;
					body.mesh.userData.labelElement.style.top = `${y - 10}px`;
				}
			});
		}
        
        // Create all celestial bodies
        const celestialBodies = [];
        let sun;
        
        celestialBodiesData.forEach(data => {
            const body = createCelestialBody(data);
            spaceContainer.add(body);
            
            if (data.isSun) {
                sun = body;
            } else {
                celestialBodies.push({
                    mesh: body,
                    distance: data.distance,
                    angle: Math.random() * Math.PI * 2,
                    speed: data.speed,
                    name: data.name
                });
            }
        });
        
        // Mouse interaction variables
        let isDragging = false;
        let previousMousePosition = {
            x: 0,
            y: 0
        };
        
        // Zoom limits
        const minZoom = 5;
        const maxZoom = 50;
        
        
        // Event listeners for mouse interaction
        document.addEventListener('mousedown', (e) => {
            isDragging = true;
        });

		// Raycasting for click effects
		const raycaster = new THREE.Raycaster();
		const mouse = new THREE.Vector2();
		const planetInfo = document.getElementById('planetInfo');
		
		// Event listeners for mouse interaction
		document.addEventListener('mousedown', (e) => {
		    isDragging = true;
		    
		    // Store click position for potential click detection
		    mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
		    mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
		});
		
		document.addEventListener('mousemove', (e) => {
		    if (isDragging) {
		        const deltaMove = {
		            x: e.clientX - previousMousePosition.x,
		            y: e.clientY - previousMousePosition.y
		        };
		        
		        // Rotate space container based on mouse movement
		        spaceContainer.rotation.y += deltaMove.x * 0.005;
		        spaceContainer.rotation.x += deltaMove.y * 0.005;
		    }
		    
		    previousMousePosition = {
		        x: e.clientX,
		        y: e.clientY
		    };
		});
		
		document.addEventListener('mouseup', (e) => {
		    // If it was a short click (not a drag), check for planet selection
		    if (isDragging && 
		        Math.abs(e.clientX - previousMousePosition.x) < 5 && 
		        Math.abs(e.clientY - previousMousePosition.y) < 5) {
		        
		        // Update mouse position for raycasting
		        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
		        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
		        
		        // Check for intersections
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(spaceContainer.children, true);

                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    
                    // Check if the object has userData (our celestial body data)
                    if (object.userData && object.userData.name) {
                        const data = object.userData;
                        
                        // Show planet info with image and description
                        planetInfo.innerHTML = `
                            <div class="planet-info-content">
                                <h2>${data.name}</h2>
                                <img src="${data.imageUrl}" alt="${data.name}" class="planet-image">
                                <div class="planet-info-stats">
                                    <p><strong>Mass:</strong> ${data.mass}</p>
                                    <p><strong>Radius:</strong> ${data.realRadius}</p>
                                    <p><strong>Distance from Sun:</strong> ${data.realDistance}</p>
                                    <p><strong>Year:</strong> ${data.yearPeriod}</p>
                                    <p><strong>Day:</strong> ${data.dayPeriod}</p>
                                </div>
                                <p class="planet-description">${data.description}</p>
                            </div>
                        `;
                        planetInfo.style.display = 'block';
                    }
                }
		    }
		    
		    isDragging = false;
		});
        
        // Add mouse wheel event for zooming
        document.addEventListener('wheel', (e) => {
            e.preventDefault();
            
            // Determine zoom direction and amount
            const zoomAmount = e.deltaY * 0.05;
            
            // Calculate new camera position
            const newZoom = camera.position.z + zoomAmount;
            
            // Apply zoom within limits
            if (newZoom >= minZoom && newZoom <= maxZoom) {
                camera.position.z = newZoom;
            }
        }, { passive: false });
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            // Update planet positions
            celestialBodies.forEach(body => {
                body.angle += body.speed;
                
                // Get inclination and eccentricity from the mesh's userData
                const inclination = body.mesh.userData.inclination * Math.PI / 180;
                const eccentricity = body.mesh.userData.eccentricity;
                
                // Calculate radius using the elliptical orbit equation
                // r = a(1-e²)/(1+e*cos(θ)) where a is semi-major axis, e is eccentricity
                const r = body.distance * (1 - eccentricity * eccentricity) / 
                         (1 + eccentricity * Math.cos(body.angle));
                
                // Calculate position on tilted elliptical orbit
                body.mesh.position.x = r * Math.cos(body.angle);
                body.mesh.position.y = r * Math.sin(body.angle) * Math.sin(inclination);
                body.mesh.position.z = r * Math.sin(body.angle) * Math.cos(inclination);
                
                // Rotate planets on their axes
                body.mesh.rotation.y += body.speed * 5;
            });
            
            // Rotate sun
            if (sun) {
                sun.rotation.y += 0.001;
            }
            
            // Slowly rotate stars for ambient effect
            if (stars) {
                stars.rotation.y += 0.0001;
            }
            
            // Update label positions
            updateLabelPositions();
            
            renderer.render(scene, camera);
        }
        
        // Start animation
        animate();
    </script>
</body>
</html>